---
phase: 01-project-setup-safety-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - main.go
  - cmd/root.go
  - go.mod
  - go.sum
  - pkg/system/.gitkeep
  - pkg/browser/.gitkeep
  - pkg/developer/.gitkeep
autonomous: true

must_haves:
  truths:
    - "Running `./mac-cleaner --version` outputs just a version number (e.g., `dev` or `0.1.0`)"
    - "Running `./mac-cleaner --help` shows terse, factual help text with no personality"
    - "Go project compiles into a `mac-cleaner` binary without errors"
  artifacts:
    - path: "main.go"
      provides: "Entry point calling cmd.Execute()"
      contains: "cmd.Execute()"
    - path: "cmd/root.go"
      provides: "Cobra root command with --version flag"
      contains: "SetVersionTemplate"
    - path: "go.mod"
      provides: "Go module definition"
      contains: "github.com/gregor/mac-cleaner"
    - path: "pkg/system/.gitkeep"
      provides: "Placeholder for Phase 2 system cache package"
    - path: "pkg/browser/.gitkeep"
      provides: "Placeholder for Phase 3 browser cache package"
    - path: "pkg/developer/.gitkeep"
      provides: "Placeholder for Phase 3 developer cache package"
  key_links:
    - from: "main.go"
      to: "cmd/root.go"
      via: "import github.com/gregor/mac-cleaner/cmd and call Execute()"
      pattern: 'cmd\.Execute\(\)'
    - from: "cmd/root.go"
      to: "cobra.Command"
      via: "rootCmd with Version field and SetVersionTemplate"
      pattern: 'SetVersionTemplate.*Version'
---

<objective>
Initialize the Go project with module, Cobra CLI framework, and directory structure.

Purpose: Establish the compilable project foundation that all future phases build on. The CLI must accept `--version` and `--help` flags with terse, technical output matching user decisions.
Output: Compilable Go binary (`mac-cleaner`) with working `--version` and `--help` flags, plus placeholder package directories for future cleaning categories.
</objective>

<execution_context>
@/Users/gregor/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gregor/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-project-setup-safety-foundation/01-RESEARCH.md
@.planning/phases/01-project-setup-safety-foundation/01-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Go module with Cobra CLI and project structure</name>
  <files>
    go.mod
    go.sum
    main.go
    cmd/root.go
    pkg/system/.gitkeep
    pkg/browser/.gitkeep
    pkg/developer/.gitkeep
  </files>
  <action>
    Initialize Go module and install Cobra:
    ```bash
    go mod init github.com/gregor/mac-cleaner
    go get github.com/spf13/cobra@latest
    ```

    Create `main.go` at project root — minimal entry point:
    ```go
    package main

    import "github.com/gregor/mac-cleaner/cmd"

    func main() {
        cmd.Execute()
    }
    ```

    Create `cmd/root.go` with Cobra root command:
    - Module-level `version` variable defaulting to `"dev"` (set via ldflags at build time: `-X github.com/gregor/mac-cleaner/cmd.version=0.1.0`)
    - `rootCmd` as `&cobra.Command{}` with:
      - `Use: "mac-cleaner"`
      - `Short:` terse description (e.g., "scan and remove macOS junk files")
      - `Long:` factual one-liner (e.g., "scan and remove system caches, browser data, developer caches, and app leftovers")
      - `Run:` function that calls `cmd.Help()` (interactive mode comes in Phase 5)
    - In `init()`: set `rootCmd.Version = version` and `rootCmd.SetVersionTemplate("{{.Version}}\n")` so `--version` outputs just the version number
    - `Execute()` function that calls `rootCmd.Execute()`, printing errors to stderr and exiting 1 on failure

    IMPORTANT per user decisions:
    - Tone must be terse and technical — no personality in help text
    - `--version` outputs ONLY the version number, no prefix like "mac-cleaner version"
    - Errors go to stderr only

    Create placeholder directories with `.gitkeep` files:
    - `pkg/system/.gitkeep`
    - `pkg/browser/.gitkeep`
    - `pkg/developer/.gitkeep`

    These establish the per-category package structure decided by the user.

    Run `go mod tidy` to finalize dependencies.
  </action>
  <verify>
    ```bash
    # Project compiles
    go build -o mac-cleaner .

    # Version flag works (outputs just version, no prefix)
    ./mac-cleaner --version
    # Expected: dev

    # Help flag works (shows terse help)
    ./mac-cleaner --help

    # Placeholder dirs exist
    ls pkg/system/.gitkeep pkg/browser/.gitkeep pkg/developer/.gitkeep

    # Clean up binary
    rm mac-cleaner
    ```
  </verify>
  <done>
    - `go build -o mac-cleaner .` compiles without errors
    - `./mac-cleaner --version` outputs `dev` (just the version, no other text)
    - `./mac-cleaner --help` shows terse, factual help text
    - `pkg/system/`, `pkg/browser/`, `pkg/developer/` directories exist with .gitkeep files
    - `go.mod` has module path `github.com/gregor/mac-cleaner` and go directive `go 1.24` or higher
  </done>
</task>

</tasks>

<verification>
1. `go build -o mac-cleaner .` succeeds
2. `./mac-cleaner --version` outputs exactly one line containing only the version string
3. `./mac-cleaner --help` output is terse and factual (no exclamation marks, no casual language)
4. `go vet ./...` reports no issues
5. All three pkg/ placeholder directories exist
</verification>

<success_criteria>
Go project compiles into `mac-cleaner` binary. The `--version` flag outputs just the version number. The `--help` flag shows terse, technical descriptions. The project structure has cmd/, pkg/system/, pkg/browser/, pkg/developer/ directories ready for future phases.
</success_criteria>

<output>
After completion, create `.planning/phases/01-project-setup-safety-foundation/01-01-SUMMARY.md`
</output>
